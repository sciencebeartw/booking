<!-- æª”æ¡ˆï¼šindex.html -->
<!-- ç‰ˆæœ¬ï¼šV30.0 (æ ¸å¿ƒæ™‚é–“æ ¡æº–èˆ‡é˜²é–ƒçˆå„ªåŒ–ç‰ˆ) -->
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±±ç†Šç§‘å­¸ - èª²ç¨‹åŠƒä½å…¥å£</title>
    <link rel="icon" href="icon.png" type="image/png">
    <link rel="apple-touch-icon" href="icon.png">
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f8f9fa; margin: 0; padding: 0; }
        
        /* å°è¦½åˆ—æ¨£å¼ (å®Œç¾ç½®ä¸­èˆ‡é–“è·åŒæ­¥) */
        header { background: #2c3e50; padding: 0; display: flex; justify-content: space-between; align-items: center; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .header-container { max-width: 1200px; margin: 0 auto; padding: 15px 20px; display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; width: 100%; box-sizing: border-box; }
        .header-left { grid-column: 2; display: flex; justify-content: center; align-items: center; gap: 20px; cursor: pointer; user-select: none; white-space: nowrap; }
        .header-left img { height: 60px; }
        .header-left h1 { margin: 0; font-size: 24px; letter-spacing: 1px; color: white; }
        .header-right { grid-column: 3; display: flex; gap: 15px; align-items: center; justify-content: flex-end; white-space: nowrap; }
        .nav-link { color: white; text-decoration: none; font-size: 15px; font-weight: bold; padding: 8px 12px; border-radius: 5px; transition: 0.3s; display: flex; align-items: center; gap: 5px; white-space: nowrap; }
        .nav-link:hover { background: rgba(255,255,255,0.1); }
        @media (max-width: 950px) { .header-container { display: flex; flex-direction: column; gap: 10px; } .header-left { white-space: normal; flex-wrap: wrap; justify-content: center; text-align: center; } .header-right { flex-wrap: wrap; justify-content: center; } .nav-link { font-size: 14px; padding: 5px 10px; } }

        .carousel { position: relative; width: 100%; height: 400px; overflow: hidden; background: #eee; margin-bottom: 20px; }
        .carousel-track { display: flex; transition: transform 0.5s ease-in-out; height: 100%; }
        .carousel-slide { min-width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; }
        .carousel-nav { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; }
        .carousel-dot { width: 12px; height: 12px; background: rgba(0,0,0,0.3); border-radius: 50%; cursor: pointer; }
        .carousel-dot.active { background: #e74c3c; }
        
        .filter-container { max-width: 1100px; margin: 0 auto; padding: 0 20px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .filter-btn { padding: 10px 20px; border: 1px solid #ddd; background: white; border-radius: 30px; cursor: pointer; font-size: 16px; transition: 0.3s; color: #555; }
        .filter-btn:hover { background: #eee; }
        .filter-btn.active { background: #2c3e50; color: white; border-color: #2c3e50; }
        
        /* â˜…â˜…â˜… ä»Šæ—¥åŠƒä½å°ˆå±¬æ¨£å¼ (ç´…) â˜…â˜…â˜… */
        .filter-btn.special-today { border-color: #e74c3c; color: #e74c3c; font-weight: bold; background: #fff5f5; }
        .filter-btn.special-today:hover { background: #ffebeb; }
        .filter-btn.special-today.active { background: #e74c3c; color: white; border-color: #e74c3c; }

        /* â˜…â˜…â˜… æœ€è¿‘åŠƒä½å°ˆå±¬æ¨£å¼ (æ©˜) â˜…â˜…â˜… */
        .filter-btn.special-upcoming { border-color: #e67e22; color: #e67e22; font-weight: bold; background: #fdf2e9; }
        .filter-btn.special-upcoming:hover { background: #fae5d3; }
        .filter-btn.special-upcoming.active { background: #e67e22; color: white; border-color: #e67e22; }

        .container { max-width: 1100px; margin: 30px auto; padding: 0 20px; display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 30px; justify-content: center; }
        .container:has(> :nth-child(1):last-child) { display: flex; justify-content: center; }
        .container:has(> :nth-child(1):last-child) .course-card { width: 100%; max-width: 400px; }
        @media (min-width: 800px) { .container:has(> :nth-child(2):last-child) { display: flex; justify-content: center; gap: 30px; } .container:has(> :nth-child(2):last-child) .course-card { width: 100%; max-width: 400px; } }
        .course-card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 20px rgba(0,0,0,0.05); transition: 0.3s; display: flex; flex-direction: column; border: 1px solid #eee; cursor: pointer; text-decoration: none; color: inherit; position: relative; }
        .course-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        .card-img { height: 200px; background-size: cover; background-position: center; background-color: #eee; }
        .card-body { padding: 25px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-category { font-size: 12px; color: #e74c3c; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .card-title { font-size: 22px; font-weight: bold; margin-bottom: 10px; color: #2c3e50; }
        .card-info { font-size: 15px; color: #555; margin-bottom: 15px; line-height: 1.6; }
        .card-footer { margin-top: auto; padding-top: 15px; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .card-price { font-size: 18px; font-weight: bold; color: #27ae60; }
        .btn-view { background: #3498db; color: white; padding: 8px 15px; border-radius: 5px; font-size: 14px; }
        .status-badge { display: inline-block; padding: 3px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; color: white; margin-left: auto; }
        .status-open { background: #27ae60; }
        .status-wait { background: #f39c12; }
        .status-full { background: #e74c3c; }
        .status-closed { background: #95a5a6; }
        .loading { text-align: center; padding: 50px; font-size: 20px; color: #999; grid-column: 1 / -1; }
        footer { text-align: center; padding: 40px; color: #999; font-size: 14px; background-color: #2c3e50; color: white; margin-top: 80px; }
        
        .float-line-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 15px; z-index: 9999; align-items: center; }
        .line-btn { width: 65px; height: 65px; border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.3); cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: white; font-family: Arial, sans-serif; transition: transform 0.2s; animation: bounce 2s ease-in-out infinite; }
        .line-btn:active { transform: scale(0.9); animation: none; }
        .line-btn span.small { font-size: 10px; font-weight: bold; margin-bottom: 2px; letter-spacing: 0px; }
        .line-btn span.large { font-size: 18px; font-weight: 900; letter-spacing: 1px; }
        
        .btn-bear { background-color: #06C755; } 
        .btn-high { background-color: #0077CC; animation-delay: 1s; } 

        @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } 60% { transform: translateY(-5px); } }
    </style>
</head>
<body>

    <header>
        <div class="header-container">
            <div class="header-left" onclick="secretKnock()">
                <img src="logo1.png" alt="å±±ç†Šç§‘å­¸">
                <h1>å±±ç†Šç§‘å­¸ / å±±ç†Šå‡å¤§</h1>
                <img src="logo2.png" alt="å±±ç†Šå‡å¤§">
            </div>
            <div class="header-right">
                <a href="sop.html" class="nav-link" target="_blank">ğŸ“– åŠƒä½é ˆçŸ¥</a>
                <a href="check.html" class="nav-link">ğŸ” æŸ¥è©¢çµæœ</a>
            </div>
        </div>
    </header>

    <div class="carousel">
        <div class="carousel-track" id="track"></div>
        <div class="carousel-nav" id="nav"></div>
    </div>

    <div id="filterContainer" class="filter-container">
        <button class="filter-btn active" id="btn-all" onclick="filterCourses('all')">å…¨éƒ¨èª²ç¨‹</button>
    </div>

    <div id="courseContainer" class="container">
        <div class="loading">æ­£åœ¨è¼‰å…¥èª²ç¨‹è³‡æ–™...</div>
    </div>

    <footer>
        &copy; 2025 å±±ç†Šç§‘å­¸å¯¦é©—æ•™å®¤ | ç³»çµ±é–‹ç™¼ï¼šSciencebear Tech Team
    </footer>

    <div class="float-line-container">
        <a href="https://lin.ee/FDQ1BLD" target="_blank" class="line-btn btn-bear" title="å±±ç†Šç§‘å­¸å®˜æ–¹LINE">
            <span class="small">å±±ç†Šç§‘å­¸</span>
            <span class="large">LINE</span>
        </a>
        <a href="https://lin.ee/kzE9NrI" target="_blank" class="line-btn btn-high" title="å±±ç†Šå‡å¤§å®˜æ–¹LINE">
            <span class="small">å±±ç†Šå‡å¤§</span>
            <span class="large">LINE</span>
        </a>
    </div>

    <script type="module">
        import { db, ref } from './firebase-config.js';
        import { onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // â˜…â˜…â˜… æ ¸å¿ƒæ™‚é–“æ ¡æº–ç›£è½ â˜…â˜…â˜…
        let serverTimeOffset = 0;
        onValue(ref(db, ".info/serverTimeOffset"), (snap) => {
            serverTimeOffset = snap.val() || 0;
        });

        let knockCount = 0;
        let knockTimer = null;
        window.secretKnock = function() {
            knockCount++;
            clearTimeout(knockTimer);
            knockTimer = setTimeout(() => { knockCount = 0; }, 2000);
            if (knockCount >= 5) {
                knockCount = 0;
                const pwd = prompt("è«‹è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼ï¼š");
                if (pwd && pwd.trim() !== "") {
                    const targetFile = "admin_" + pwd.trim() + ".html";
                    fetch(targetFile, { method: 'HEAD' })
                        .then(response => {
                            if (response.ok) window.location.href = targetFile;
                            else alert("å¯†ç¢¼éŒ¯èª¤ï¼");
                        })
                        .catch(error => alert("ç³»çµ±éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚"));
                }
            }
        };

        const track = document.getElementById('track');
        const nav = document.getElementById('nav');
        let currentSlide = 0;
        let slideCount = 0;
        
        // â˜…â˜…â˜… é˜²é–ƒçˆå„ªåŒ–ï¼šæ©«å¹…å¿«ç…§ç´€éŒ„ â˜…â˜…â˜…
        let currentBannersStr = ""; 

        onValue(ref(db, 'banners'), snapshot => {
            const data = snapshot.val() || {};
            const newBannersStr = JSON.stringify(data);

            // å¦‚æœè³‡æ–™è·Ÿä¸Šæ¬¡ä¸€æ¨¡ä¸€æ¨£ï¼Œç›´æ¥ä¸­æ–·ï¼Œä¸é‡ç¹ª HTML
            if (currentBannersStr === newBannersStr) return; 
            currentBannersStr = newBannersStr;

            track.innerHTML = "";
            nav.innerHTML = "";
            const banners = Object.values(data);
            slideCount = banners.length;
            if (slideCount === 0) {
                track.innerHTML = '<div class="carousel-slide" style="background-image: url(\'https://via.placeholder.com/1200x400?text=Welcome\');"></div>';
                return;
            }
            banners.forEach((b, index) => {
                const slide = document.createElement('div');
                slide.className = 'carousel-slide';
                slide.style.backgroundImage = `url('${b.url}')`;
                track.appendChild(slide);
                const dot = document.createElement('div');
                dot.className = `carousel-dot ${index === 0 ? 'active' : ''}`;
                dot.onclick = () => goToSlide(index);
                nav.appendChild(dot);
            });
        });

        function goToSlide(index) {
            currentSlide = index;
            track.style.transform = `translateX(-${index * 100}%)`;
            document.querySelectorAll('.carousel-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
        }
        setInterval(() => {
            if (slideCount > 1) {
                currentSlide = (currentSlide + 1) % slideCount;
                goToSlide(currentSlide);
            }
        }, 5000);

        const courseContainer = document.getElementById('courseContainer');
        const filterContainer = document.getElementById('filterContainer');
        let allCourses = [];
        let seatsStatus = {}; 
        let waitlistStatus = {}; 
        let categories = new Set();
        let currentCategory = 'all';
        let isFirstLoad = true; 

        // â˜…â˜…â˜… åˆ¤æ–·æ˜¯å¦ç‚ºã€Œä»Šå¤©ã€ (å°å…¥ä¼ºæœå™¨æ™‚é–“æ ¡æº–) â˜…â˜…â˜…
        function isToday(timestamp) {
            const d = new Date(timestamp);
            const today = new Date(Date.now() + serverTimeOffset);
            return d.getDate() === today.getDate() &&
                   d.getMonth() === today.getMonth() &&
                   d.getFullYear() === today.getFullYear();
        }

        // â˜…â˜…â˜… åˆ¤æ–·æ˜¯å¦ç‚ºã€Œæœªä¾†çš„ä¸€å¤©ã€ (å°å…¥ä¼ºæœå™¨æ™‚é–“æ ¡æº–) â˜…â˜…â˜…
        function isFutureDay(timestamp) {
            const d = new Date(timestamp);
            const today = new Date(Date.now() + serverTimeOffset);
            d.setHours(0, 0, 0, 0);
            today.setHours(0, 0, 0, 0);
            return d.getTime() > today.getTime();
        }

        onValue(ref(db, 'courses'), (snapshot) => {
            const data = snapshot.val();
            allCourses = [];
            categories = new Set();
            
            let hasTodayCourses = false;    
            let hasUpcomingCourses = false; 

            if (!data) {
                courseContainer.innerHTML = '<div class="loading">ç›®å‰æ²’æœ‰é–‹æ”¾çš„èª²ç¨‹ã€‚</div>';
                return;
            }

            Object.keys(data).forEach(key => {
                const c = data[key];
                c.id = key; 
                allCourses.push(c);
                if (c.grade) categories.add(c.grade);

                if (c.start1) {
                    const start1Time = new Date(c.start1).getTime();
                    if (isToday(start1Time)) {
                        hasTodayCourses = true;
                    } else if (isFutureDay(start1Time)) {
                        hasUpcomingCourses = true;
                    }
                }
            });

            filterContainer.innerHTML = '<button class="filter-btn" id="btn-all" onclick="filterCourses(\'all\')">å…¨éƒ¨èª²ç¨‹</button>';

            if (hasTodayCourses) {
                const btnToday = document.createElement('button');
                btnToday.className = 'filter-btn special-today';
                btnToday.textContent = 'ğŸ”¥ ä»Šæ—¥åŠƒä½';
                btnToday.onclick = () => window.filterCourses('today');
                filterContainer.appendChild(btnToday);
            } else if (hasUpcomingCourses) {
                const btnUpcoming = document.createElement('button');
                btnUpcoming.className = 'filter-btn special-upcoming';
                btnUpcoming.textContent = 'â³ æœ€è¿‘åŠƒä½';
                btnUpcoming.onclick = () => window.filterCourses('upcoming');
                filterContainer.appendChild(btnUpcoming);
            }

            const gradeOrder = ["å‡å°äº”èª²ç¨‹", "å‡å°å…­èª²ç¨‹", "å‡åœ‹ä¸€èª²ç¨‹", "å‡åœ‹äºŒèª²ç¨‹", "å‡åœ‹ä¸‰èª²ç¨‹", "å‡é«˜ä¸€èª²ç¨‹", "å‡é«˜äºŒèª²ç¨‹", "å‡é«˜ä¸‰èª²ç¨‹"];
            const sortedCategories = Array.from(categories).sort((a, b) => gradeOrder.indexOf(a) - gradeOrder.indexOf(b));
            
            sortedCategories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.textContent = cat;
                btn.onclick = () => window.filterCourses(cat);
                filterContainer.appendChild(btn);
            });

            if (isFirstLoad) {
                if (hasTodayCourses) {
                    currentCategory = 'today';
                } else if (hasUpcomingCourses) {
                    currentCategory = 'upcoming';
                } else {
                    currentCategory = 'all';
                }
                isFirstLoad = false;
            }

            window.filterCourses(currentCategory, true);
        });

        onValue(ref(db, 'seats'), (snapshot) => {
            const data = snapshot.val() || {};
            seatsStatus = {};
            Object.keys(data).forEach(courseId => {
                const seats = data[courseId];
                let soldCount = 0;
                Object.keys(seats).forEach(seatId => {
                    if (seatId === '_settings') return;
                    if (seats[seatId].status === 'sold') {
                        soldCount++;
                    }
                });
                seatsStatus[courseId] = { sold: soldCount };
            });
            refreshDisplay();
        });

        onValue(ref(db, 'waitlist'), (snapshot) => {
            const data = snapshot.val() || {};
            waitlistStatus = {};
            Object.keys(data).forEach(courseId => {
                let count = 0;
                Object.values(data[courseId]).forEach(w => {
                    if (w.status !== 'deleted') count++;
                });
                waitlistStatus[courseId] = count;
            });
            refreshDisplay();
        });

        function refreshDisplay() {
            if (allCourses.length === 0) return;
            
            // â˜…â˜…â˜… å°å…¥ä¼ºæœå™¨æ™‚é–“æ ¡æº– â˜…â˜…â˜…
            const now = Date.now() + serverTimeOffset;
            
            const visibleCourses = allCourses.filter(c => {
                const start = c.displayStart ? new Date(c.displayStart).getTime() : 0;
                const end = c.displayEnd ? new Date(c.displayEnd).getTime() : 9999999999999;
                return now >= start && now <= end;
            });

            let finalCourses = visibleCourses;
            
            if (currentCategory === 'today') {
                finalCourses = visibleCourses.filter(c => c.start1 && isToday(new Date(c.start1).getTime()));
            } else if (currentCategory === 'upcoming') {
                finalCourses = visibleCourses.filter(c => c.start1 && isFutureDay(new Date(c.start1).getTime()));
            } else if (currentCategory !== 'all') {
                finalCourses = visibleCourses.filter(c => c.grade === currentCategory);
            }

            renderCourses(finalCourses);
        }

        setInterval(refreshDisplay, 1000);

        function getStatusBadge(c, now) {
            const start1 = new Date(c.start1).getTime();
            const end1 = c.end1 ? new Date(c.end1).getTime() : 9999999999999;
            const start2 = c.start2 ? new Date(c.start2).getTime() : 9999999999999;
            const end2 = c.end2 ? new Date(c.end2).getTime() : 9999999999999;
            
            const hasEnd1 = c.end1 && new Date(c.end1).getFullYear() < 3000;
            const hasStart2 = c.start2 && new Date(c.start2).getFullYear() < 3000;
            const hasEnd2 = c.end2 && new Date(c.end2).getFullYear() < 3000;

            const soldCount = (seatsStatus[c.id] && seatsStatus[c.id].sold) || 0;
            const totalSeats = c.totalSeats || 999; 
            const isFull = soldCount >= totalSeats;

            const waitlistCount = waitlistStatus[c.id] || 0;
            const waitlistLimit = c.waitlistLimit || 0;
            const isWaitlistFull = (waitlistLimit > 0 && waitlistCount >= waitlistLimit);

            if (now < start1) return '<div class="status-badge status-closed">å°šæœªé–‹æ”¾</div>';

            if (now >= start1 && now < end1) {
                if (isFull) {
                    if (hasStart2) {
                        return '<div class="status-badge status-full">ğŸ”´ æ­¤éšæ®µå·²é¡æ»¿</div>';
                    } else {
                        if (c.waitlistEnabled) {
                            if (isWaitlistFull) return '<div class="status-badge status-full">ğŸ”´ å€™è£œå·²é¡æ»¿</div>';
                            return '<div class="status-badge status-wait">ğŸŸ¡ é–‹æ”¾å€™è£œä¸­</div>';
                        }
                        return '<div class="status-badge status-full">ğŸ”´ æ­¤éšæ®µå·²é¡æ»¿</div>';
                    }
                }
                return '<div class="status-badge status-open">ğŸŸ¢ é–‹æ”¾åŠƒä½ä¸­</div>';
            }

            if (hasEnd1 && hasStart2 && now >= end1 && now < start2) {
                return '<div class="status-badge status-closed">â›” åº§ä½æ•´ç†ä¸­</div>';
            }

            if (hasStart2 && now >= start2 && now < end2) {
                if (isFull) {
                    if (c.waitlistEnabled) {
                        if (isWaitlistFull) return '<div class="status-badge status-full">ğŸ”´ å€™è£œå·²é¡æ»¿</div>';
                        return '<div class="status-badge status-wait">ğŸŸ¡ é–‹æ”¾å€™è£œä¸­</div>';
                    }
                    return '<div class="status-badge status-full">ğŸ”´ æ­¤éšæ®µå·²é¡æ»¿</div>';
                }
                return '<div class="status-badge status-open">ğŸŸ¢ é–‹æ”¾åŠƒä½ä¸­</div>';
            }

            if ((hasEnd2 && now >= end2) || (!hasStart2 && hasEnd1 && now >= end1)) {
                return '<div class="status-badge status-full">ğŸ”´ åŠƒä½å·²çµæŸ</div>';
            }
            
            return '<div class="status-badge status-closed">å°šæœªé–‹æ”¾</div>';
        }

        function renderCourses(courses) {
            if (courses.length === 0) {
                courseContainer.innerHTML = '<div class="loading">ç›®å‰æ²’æœ‰ç¬¦åˆçš„èª²ç¨‹ã€‚</div>';
                return;
            }

            const currentIds = new Set(courses.map(c => `card-${c.id}`));
            Array.from(courseContainer.children).forEach(child => {
                if (child.id && !currentIds.has(child.id) && !child.classList.contains('loading')) {
                    courseContainer.removeChild(child);
                }
            });
            
            const loadingEl = courseContainer.querySelector('.loading');
            if (loadingEl) courseContainer.removeChild(loadingEl);

            // é€™è£¡çš„ now æœƒæ˜¯ç”± refreshDisplay å‚³é€²ä¾†çš„ä¼ºæœå™¨æ™‚é–“ï¼Œéå¸¸ç²¾æº–ï¼
            const now = Date.now() + serverTimeOffset;

            courses.forEach(c => {
                const statusBadge = getStatusBadge(c, now);
                const cardId = `card-${c.id}`;
                let card = document.getElementById(cardId);

                if (card) {
                    const badgeContainer = card.querySelector('.status-badge-container');
                    if (badgeContainer.innerHTML !== statusBadge) {
                        badgeContainer.innerHTML = statusBadge;
                    }
                } else {
                    card = document.createElement('a');
                    card.className = 'course-card';
                    card.id = cardId; 
                    card.href = `detail.html?id=${c.id}`; 
                    
                    card.innerHTML = `
                        <div class="card-img" style="background-image: url('${c.image || 'https://via.placeholder.com/400x200'}');"></div>
                        <div class="card-body">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">
                                <div class="card-category">${c.grade}</div>
                                <div class="status-badge-container">${statusBadge}</div>
                            </div>
                            <div class="card-title">${c.subject} ${c.classType || ''}</div>
                            <div class="card-info">
                                ğŸ‘¨â€ğŸ« ${c.teacher}<br>
                                â° ${c.timeDescription || 'æ™‚é–“æœªå®š'}
                            </div>
                            <div class="card-footer">
                                <div class="card-price">${c.price}</div>
                                <div class="btn-view">æŸ¥çœ‹è©³æƒ… âœ</div>
                            </div>
                        </div>
                    `;
                    courseContainer.appendChild(card);
                }
            });
        }

        window.filterCourses = function(category, noRefresh = false) {
            currentCategory = category;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent === category || 
                   (category === 'all' && btn.textContent === 'å…¨éƒ¨èª²ç¨‹') ||
                   (category === 'today' && btn.textContent === 'ğŸ”¥ ä»Šæ—¥åŠƒä½') ||
                   (category === 'upcoming' && btn.textContent === 'â³ æœ€è¿‘åŠƒä½')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            if (!noRefresh) refreshDisplay();
        };
    </script>
</body>
</html>